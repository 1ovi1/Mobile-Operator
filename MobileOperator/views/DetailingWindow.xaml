<Window x:Class="MobileOperator.DetailingWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MobileOperator"
        mc:Ignorable="d"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Мобильный оператор" Height="800" Width="900">
    <Grid Background="#1A1A1A">
        <!-- Шапка -->
        <Border VerticalAlignment="Top" Height="70">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Color="#FF8C00" Offset="0"/>
                    <GradientStop Color="#FFA500" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <TextBlock Text="Детализация звонков" 
                       Foreground="#1A1A1A" 
                       FontWeight="Bold" 
                       FontSize="36" 
                       VerticalAlignment="Center" 
                       HorizontalAlignment="Center"/>
        </Border>

        <!-- Навигационное меню -->
        <Grid Margin="0,70,0,0" VerticalAlignment="Top" Height="50">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1*"/>
                <ColumnDefinition Width="1*"/>
                <ColumnDefinition Width="1*"/>
                <ColumnDefinition Width="1*"/>
                <ColumnDefinition Width="1*"/>
            </Grid.ColumnDefinitions>

            <Button Command="{Binding OpenMainWindow}" 
                    Content="Мой кабинет" 
                    FontSize="18" 
                    Background="#2A2A2A" 
                    Foreground="#FFA500" 
                    BorderBrush="#FF8C00"
                    BorderThickness="1"
                    Grid.Column="0"/>

            <Button Command="{Binding OpenServices}" 
                    Content="Услуги" 
                    FontSize="18" 
                    Background="#2A2A2A" 
                    Foreground="#FFA500" 
                    BorderBrush="#FF8C00"
                    BorderThickness="1"
                    Grid.Column="1"/>

            <Button Command="{Binding OpenRates}" 
                    Content="Тарифы" 
                    FontSize="18" 
                    Background="#2A2A2A" 
                    Foreground="#FFA500" 
                    BorderBrush="#FF8C00"
                    BorderThickness="1"
                    Grid.Column="2"/>

            <Button Content="Звонки" 
                    FontSize="18" 
                    Background="#FFA500" 
                    Foreground="#1A1A1A" 
                    FontWeight="Bold"
                    BorderThickness="0"
                    Grid.Column="3"/>

            <Button Command="{Binding OpenDetailing2}" 
                    Content="Тарифы и услуги" 
                    FontSize="18" 
                    Background="#2A2A2A" 
                    Foreground="#FFA500" 
                    BorderBrush="#FF8C00"
                    BorderThickness="1"
                    Grid.Column="4"/>
        </Grid>

        <!-- Основной контент -->
        <Grid Margin="15,135,15,15">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Заголовок -->
            <TextBlock Text="Получите распечатку звонков за выбранный период" 
                       TextAlignment="Center" 
                       FontSize="24" 
                       Foreground="#FFD700"
                       FontWeight="Bold"
                       Margin="0,0,0,15"
                       Grid.Row="0"/>

            <!-- Выбор периода -->
            <Border Background="#2A2A2A" 
                    BorderBrush="#FF8C00" 
                    BorderThickness="2" 
                    CornerRadius="15" 
                    Padding="25" 
                    Margin="0,0,0,15"
                    Grid.Row="1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Text="Укажите период: с" 
                               FontSize="18" 
                               Foreground="#FFD700"
                               VerticalAlignment="Center"
                               Margin="0,0,10,0"
                               Grid.Column="0"/>

                    <DatePicker SelectedDate="{Binding Path=From}" 
                                Width="150"
                                Background="#1A1A1A"
                                Foreground="#FFA500"
                                BorderBrush="#FF8C00"
                                Margin="0,0,10,0"
                                Grid.Column="1"/>

                    <TextBlock Text="по" 
                               FontSize="18" 
                               Foreground="#FFD700"
                               VerticalAlignment="Center"
                               Margin="0,0,10,0"
                               Grid.Column="2"/>

                    <DatePicker SelectedDate="{Binding Path=Till}" 
                                Width="150"
                                Background="#1A1A1A"
                                Foreground="#FFA500"
                                BorderBrush="#FF8C00"
                                Margin="0,0,20,0"
                                Grid.Column="3"/>

                    <Button Command="{Binding GetDetailingCommand}" 
                            Content="Сформировать выписку"
                            Foreground="#1A1A1A" 
                            Background="#FFD700" 
                            FontSize="16" 
                            FontWeight="Bold"
                            Height="40"
                            Width="240"
                            BorderThickness="0"
                            HorizontalAlignment="Left"
                            Grid.Column="4"/>
                </Grid>
            </Border>

            <!-- Таблица звонков -->
            <Border Background="#2A2A2A" 
                    BorderBrush="#FF8C00" 
                    BorderThickness="2" 
                    CornerRadius="15" 
                    Padding="20" 
                    Margin="0,0,0,15"
                    Grid.Row="2">
                <DataGrid x:Name="DetailingDataGrid" 
                          FontSize="16" 
                          CanUserAddRows="False" 
                          ItemsSource="{Binding Calls}"
                          AutoGenerateColumns="False" 
                          ColumnWidth="*"
                          Background="#1A1A1A"
                          Foreground="#FFA500"
                          BorderBrush="#FF8C00"
                          BorderThickness="1"
                          RowBackground="#2A2A2A"
                          AlternatingRowBackground="#1A1A1A"
                          HeadersVisibility="Column"
                          GridLinesVisibility="None">
                    <DataGrid.ColumnHeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="Background" Value="#FF8C00"/>
                            <Setter Property="Foreground" Value="#1A1A1A"/>
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Setter Property="Padding" Value="10"/>
                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                        </Style>
                    </DataGrid.ColumnHeaderStyle>
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Собеседник" Binding="{Binding Number}" IsReadOnly="True" />
                        <DataGridTextColumn Header="Тип" Binding="{Binding TypeName}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Направление" Binding="{Binding Direction}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Списание (₽)" Binding="{Binding Cost}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Время" Binding="{Binding TimeToString, StringFormat=G}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Длительность" Binding="{Binding Duration}" IsReadOnly="True"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Border>

            <!-- Кнопки экспорта -->
            <Grid Grid.Row="3">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1*"/>
                    <ColumnDefinition Width="1*"/>
                </Grid.ColumnDefinitions>

                <Button Command="{Binding PrintToExelDetailingCommand}" 
                        Content="Скачать выписку в xlsx"
                        Foreground="#1A1A1A" 
                        Background="#FFD700" 
                        FontSize="16" 
                        FontWeight="Bold"
                        Height="45"
                        Width="320"
                        BorderThickness="0"
                        HorizontalAlignment="Center"
                        Grid.Column="0"/>

                <Button Command="{Binding PrintToWordDetailingCommand}" 
                        Content="Скачать выписку в doc"
                        Foreground="#1A1A1A" 
                        Background="#FFD700" 
                        FontSize="16" 
                        FontWeight="Bold"
                        Height="45"
                        Width="320"
                        BorderThickness="0"
                        HorizontalAlignment="Center"
                        Grid.Column="1"/>
            </Grid>
        </Grid>
    </Grid>
</Window>